pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
-- fonctions

cls()
map(0,0,0,0)
spr(1,60,60)

function _init()
	create_player()
	state = 0
	blinking = true
	timer = 0
end

function _update()
if (state>=0) update_game()
if (state>=5) update_gameover()
timer+=1
augmente_state()
end

function _draw()
cls()
if (state>=0) draw_game()
if (state>=5) draw_gameover()
end

function update_game()
player_movement()
if check_flag(1,newx,newy) then
	state += 1
	end
 
end

function update_gameover()
	if (btn(‚ùé)) _init()
end

function draw_game()
 draw_background()
 draw_map()
 draw_player()
 draw_healthbar()
end
-->8
-- personnage

function create_player()
 p={
	 x=2,
	 y=11,
	 sprite=1
 }
end




function player_movement()
newx=p.x
newy=p.y

	if (btnp(‚û°Ô∏è)) newx+=1
	if (btnp(‚¨ÜÔ∏è)) newy-=1
	if (btnp(‚¨áÔ∏è)) newy+=1
	if (btnp(‚¨ÖÔ∏è)) newx-=1
	
	if not check_flag(0,newx,newy) then
	p.x=newx
	p.y=newy
	end	
end

function draw_player()
spr(p.sprite,newx*8,newy*8)
end

-->8
-- map
function draw_map()
	map(0,0,0,0,128,64)
	end
	
function check_flag(flag,x,y)
	local sprite=mget(x,y)
	return fget(sprite,flag)
end

-->8
-- environnement

function draw_background()
 rectfill(0,0,128,128,12)
 rectfill(0,95,128,128,3)
 circfill(64,32,15,7)
 circfill(50,38,10,7)
 circfill(77,38,10,7)
 circfill(62,35,14,7)
 circfill(115,0,20,9)
 circfill(115,0,18,10)
 end
 

-->8
-- ecran de gameover
function draw_gameover()
cls()
 rectfill(0,0,128,128,0)
 print('game over !!!',45,46,2)
 print('game over !!!',44,45,8)
	if timer%20 == 0 then 
	blinking = not blinking
	end
	if blinking then 
	print('appuyez sur x', 45,71,1)
	print('pour ressayer !',41,81,1)
	print('appuyez sur x', 44, 70,9)
	print('pour ressayer !',40, 80,9)
	end
end


-- healthbar ‚ô•
function healthbar_full()
spr(28,0,0)
spr(29,8,0)
spr(44,0,8)
spr(45,8,8)
end

function healthbar_2()
spr(26,0,0)
spr(27,8,0)
spr(42,0,8)
spr(43,8,8)
end

function healthbar_3()
spr(24,0,0)
spr(25,8,0)
spr(40,0,8)
spr(41,8,8)
end

function healthbar_4()
spr(22,0,0)
spr(23,8,0)
spr(38,0,8)
spr(39,8,8)
end

function healthbar_5()
spr(20,0,0)
spr(21,8,0)
spr(36,0,8)
spr(37,8,8)
end

function draw_healthbar()
 if state == 0 then
 healthbar_full()
 end
 if state == 1 then
 healthbar_2()
 end
 if state == 2 then
 healthbar_3()
 end
 if state == 3 then
 healthbar_4()
 end
 if state == 4 then
 healthbar_5()
 end
end
-->8
--enemies
function augmente_state()
if (btn(üÖæÔ∏è)) then 
state += 1
end

end
__gfx__
0000000000039a0000039a0000039a0000011100000000000000000060ddd0d00000000000000000000000000000000000000000000000000000000000000000
00000000033444300334443003344430011ccc10000000000000000056868d500000000000000000000000000000000000000000000000000000000000000000
0070070033414410334144103341441011c0cc000000000000000000006660000000000000000000000000000000000000000000000000000000000000000000
0007700033444440334444403344444011ccccc00000000000000000055055000000000000000000000000000000000000000000000000000000000000000000
00077000000b4b00000b4b00000b4b000006c60000000000000000006066d0d00000000000000000000000000000000000000000000000000000000000000000
0070070000b7b70000b7b70000b7b700006767000000000000000000905550200000000000000000000000000000000000000000000000000000000000000000
000000000bb4b4000bb4bb400b4bb400066c6c0000000000000000000060d0000000000000000000000000000000000000000000000000000000000000000000
00000000000550000050500000050500000770000000000000000000055055000000000000000000000000000000000000000000000000000000000000000000
49444494055000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44000094565500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
04900440566550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00444400566651000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00094000552661100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00044000565266110000000000000000002299222222220000229922222222000022992222222200002299222222220000229922222222000000000000000000
00044000566616610000000000000000028000070077709002888807007770900288888780777090028888878877709002888887887778900000000000000000
00049000011111100000000000000000288000000000000228888800000000022888888880000002288888888888000228888888888888820000000000000000
000000000000000000000000000000000a800000000000200a888800000000200a888888800000200a888888888800200a888888888888200000000000000000
00000000000000000000000000000000002222229299220000222222929922000022222292992200002222229299220000222222929922000000000000000000
__gff__
0000000000000003000000000000000001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
00 00424344

