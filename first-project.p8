pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
-- fonctions

cls()
map(0,0,0,0)
spr(1,60,60)

function _init()
	create_player()
	state = 0
	blinking = true
	timer = 0
end

function _update()
if (state==0) update_game()
if (state==1) update_gameover()
timer+=1
end

function _draw()
cls()
if (state==0) draw_game()
if (state==1) draw_gameover()
end

function update_game()
player_movement()
state = 0
if check_flag(1,newx,newy) then
	state = 1
	end
 
end

function update_gameover()
	if (btn(❎)) _init()
end

function draw_game()
 draw_background()
 draw_map()
 draw_player()
end
-->8
-- personnage

function create_player()
 p={
	 x=2,
	 y=11,
	 sprite=1
 }
end




function player_movement()
newx=p.x
newy=p.y

	if (btnp(➡️)) newx+=1
	if (btnp(⬆️)) newy-=1
	if (btnp(⬇️)) newy+=1
	if (btnp(⬅️)) newx-=1
	
	if not check_flag(0,newx,newy) then
	p.x=newx
	p.y=newy
	end	
end

function draw_player()
spr(p.sprite,newx*8,newy*8)
end

-->8
-- map
function draw_map()
	map(0,0,0,0,128,64)
	end
	
function check_flag(flag,x,y)
	local sprite=mget(x,y)
	return fget(sprite,flag)
end

-->8
-- environnement

function draw_background()
 rectfill(0,0,128,128,12)
 rectfill(0,95,128,128,3)
 circfill(64,32,15,7)
 circfill(50,38,10,7)
 circfill(77,38,10,7)
 circfill(62,35,14,7)
 circfill(115,0,20,9)
 circfill(115,0,18,10)
 end
-->8
-- ecran de gameover
function draw_gameover()
cls()
 rectfill(0,0,128,128,0)
 print('game over !!!',44,55,8)
	if timer%20 == 0 then 
	blinking = not blinking
	end
	if blinking then 
	print('appuyez sur x pour ressayer', 15, 80,9)
	end
end



-->8
--enemies
if check_flag(1,newx,newy) then
	state = 1
	end
__gfx__
0000000000039a0000039a0000039a0000011100000000000000000060ddd0d00000000000000000000000000000000000000000000000000000000000000000
00000000033444300334443003344430011ccc10000000000000000056868d500000000000000000000000000000000000000000000000000000000000000000
0070070033414410334144103341441011c0cc000000000000000000006660000000000000000000000000000000000000000000000000000000000000000000
0007700033444440334444403344444011ccccc00000000000000000055055000000000000000000000000000000000000000000000000000000000000000000
00077000000b4b00000b4b00000b4b000006c60000000000000000006066d0d00000000000000000000000000000000000000000000000000000000000000000
0070070000b7b70000b7b70000b7b700006767000000000000000000905550200000000000000000000000000000000000000000000000000000000000000000
000000000bb4b4000bb4bb400b4bb400066c6c0000000000000000000060d0000000000000000000000000000000000000000000000000000000000000000000
00000000000550000050500000050500000770000000000000000000055055000000000000000000000000000000000000000000000000000000000000000000
49444494055000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44000094565500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
04900440566550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00444400566651000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00094000552661100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00044000565266110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00044000566616610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00049000011111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000002000000000000000001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000010100000000000000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
00 00424344

