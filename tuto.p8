pico-8 cartridge // http://www.pico-8.com
version 38
__lua__



function _init()
p={}
p.x=5
p.y=5
p.dx=0
p.dy=0
create_snow()
state=0

timer=0
blinking=true

end

function _draw()
cls()
map(0,0,0,0,16,16)
if (is_grounded()) then
p.y=flr(flr(p.y)/8)*8
end
spr(1,p.x,p.y)

for s in all(snow) do
pset(s.x,s.y,s.col)
 end
 
if (state>=1) draw_gameover()
print(state, p.x, 0,1)
end

function is_grounded()
bloc=mget(flr(p.x+4)/8,flr(p.y)/8+1)
return fget(bloc,0)
end


function  _update()
update_camera()
p.dx=0


if check_flag(1,(p.x)/8,(p.y)/8) then
	state += 1
	end
	
	
if (btn(0)) p.dx=-1
if (btn(1)) p.dx=1
p.x+=p.dx

if (is_grounded()) then
p.dy=0
if(btnp(2))p.dy=-2
else
p.dy+=0.1
if(p.dy>4)p.dy=4
end
p.y+=p.dy

update_snow()

	timer+=1
end


-->8
--camera

function update_camera()
camx=mid(0,p.x-(7.5*8),16*8)
--camy=mid(0,p.y+7.5,16)
camera(camx)
end
-->8
--effets
function update_snow()
 for s in all(snow) do
	s.y+=s.speed
  if s.y>128 then
		s.y=0
		s.x=rnd(256)
  end
 end
end

function create_snow()
snow={}
for i=1,20 do
local new_snow={
x=rnd(128),
y=rnd(128),
col=6,
speed=2}
add(snow, new_snow)
 end
end

-->8
-- flag 
	
function check_flag(flag,x,y)
	local sprite=mget(x,y)
	return fget(sprite,flag)
end
-->8
-- ecran de gameover
function draw_gameover()
cls()
 rectfill(0,0,128,128,0)
 print('game over !!!',45,46,2)
 print('game over !!!',44,45,8)
	if timer%20 == 0 then 
	blinking = not blinking
	end
	if blinking then 
	print('appuyez sur x', 45,71,1)
	print('pour ressayer !',41,81,1)
	print('appuyez sur x', 44, 70,9)
	print('pour ressayer !',40, 80,9)
	end
end
__gfx__
0000000000039a000033304000000000bbbbbbb3bb8bbbbbbbbbbbbbbbbbbbbbbbbbbbbb11111111000000000000000000000000000000000000000000000000
00000000033444600333330400000000b3bbb3b3b8a8bbbbbbbbbbbbbbbbbb33bbbbbbbb88888888000000000000000000000000000000000000000000000000
00700700334414660f0f0f0400000000b3b3b3bbbb8bbbbbbbbbbbbbbbbbb3333bbbbbbb88888888000b0b000000000000000000000000000000000000000000
00077000334444060fffff0400000000bbb3bbbbbbbbb8bbbbbbbbbbbbbb333333bbbbbb8888888800b0b0b00000000000000000000000000000000000000000
00077000000b40063333333f00000000bbbbbb3bbbbb8a8bbbbbbbbbbbbbb3333bbbbbbb8888888800b000b00000000000000000000000000000000000000000
0070070000bb7446f4464404000000003bbbbb3bb8bbb8bbbbbbbbbbbbbb3333333bbbbb8888888800bbbbb00000000000000000000000000000000000000000
000000000bbbb06603333354000000003bb3bbbb8a8bbbbbbbbbbbbbbbbbb33333bbbbbb888888880b00000b0000000000000000000000000000000000000000
00000000000550605000004000000000bbb3bb3bb8bbbbbbbbbbbbbbbbbb3333333bbbbb88888888000000000000000000000000000000000000000000000000
00000000000000000000000000000000cccccccccccc3cc3ccccccccbbb333333333bbbb00000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000ccccccccc3cc3cc3c33333ccbbbb3333333bbbbb00000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000ccccccccc3ccccc3ccc3333cbbb333333333bbbb00000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000cccccccccc3cc3ccc33333ccbbbb33333333bbbb00000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000cccccccccc3cc3cccc33333cbb33334443333bbb00000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000cccccccccc3cc3cccc3333ccbbbbb34443bbbbbb00000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000cccccccc3cc3ccc3c333333cbbbbbb444bbbbbbb00000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000cccccccc3cc3ccc3ccccccccbbbbbbbbbbbbbbbb00000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000102000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
060606060606060606060606060606060a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
060504060506060506070806060405060a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
060606060606070806171806060606060a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
070805040708171806090909090506060a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
171806061718050504040606060708060a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060406060606060505060617180600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606070805060606060606070804060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606171806060909090606171806060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606170606060506040604060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060605060708060607080609090800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0607080606061718060617180606171800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
061718090909060406060a060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060708060409090906060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0609090506061718060909090914060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060606060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0909090909090909090909090909090900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000900000000000000000900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
090909090909090909090909090909091a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1a191a0000190900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1a191a191a191a191a191a191a191a191a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
